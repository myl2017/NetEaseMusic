"use strict";function remove(){$(".disc .light").removeClass("playing"),$(".disc .cover").removeClass("playing"),$(".icon-wrap").removeClass("playing")}function add(){$(".disc .light").addClass("playing"),$(".disc .cover").addClass("playing"),$(".icon-wrap").addClass("playing")}$(function(){function e(e){function n(e){return e>=10?e+"":"0"+e}var t=document.createElement("audio");t.src=e,document.body.appendChild(t),$(".icon-play").on("click",function(){t.play(),add()}),$(".icon-pause").on("click",function(){t.pause(),remove()}),t.onended=function(){remove()},setInterval(function(){for(var e=t.currentTime,a=~~(e/60),i=e-60*a,r=n(a)+":"+n(i),o=$(".lines > p"),c=void 0,s=0;s<o.length;s++){var l=o.eq(s).attr("data-time"),d=o.eq(s+1).attr("data-time");if(0!==o.eq(s+1).length&&l<r&&d>r){c=o.eq(s);break}}if(c){c.addClass("active").prev().removeClass("active");var u=c.offset().top-$(".lines").offset().top-$(".lyric").height()/3;$(".lines").css("transform","translateY(-"+u+"px)")}},300)}function n(e,n,t){$(".song-description h1 .songName").text(e),$(".song-description h1 .author").text(n),a.call(void 0,t)}function t(e,n){$(".page").css("background-image","url("+e+")"),$(".disc > .cover").removeAttr("src"),$(".disc > .cover").attr("src",""+n)}function a(e){var n=e.split("\n"),t=/^\[(.+)\](.*)$/;n=n.map(function(e,n){var a=e.match(t);if(a)return{time:a[1],words:a[2]}});var a=$(".lines");n.map(function(e){if(e){var n=$("<p/>");n.attr("data-time",e.time).text(e.words),n.appendTo(a)}})}var i=parseInt(location.search.match(/\bid=([^&]*)/)[1],10);$.get("./database.json").then(function(a){var r=a.filter(function(e){return e.id===i})[0],o=r.url,c=r.name,s=r.singer,l=r.lyric,d=r.pagebg,u=r.cover;e(o),t(d,u),n(c,s,l)},function(){console.log("error")})});